#!/usr/bin/python
# -*- coding: utf-8 -*-
#

from ipaddr import IPv4Address, IPv6Address
from scapy.all import *


src=IPv6Address("2001:700:100:279::4")
#dst=IPv6Address("2a02:2e0:3fe:1001:302::")
dst=IPv6Address("2a02:270:2014:111:77:88:71:151")

#src=str(src),
ip =  IPv6(src=str(src), dst=str(dst), hlim=64)
icmp = ICMPv6EchoRequest(id=RandShort(), seq=1, data="AAAAAAAAAABBBBBBBBBBCCCCCCCCCCDDDDDDDDDDEEEEEEEEEEFFFFFF")

packet = ip / icmp
packet.show()

#scapy.all.sendp(packet)

timeout=3
#filter=None

answered,unanswered = scapy.all.srp(packet, timeout=timeout, verbose=0)
print("Answered:")
answered.show()
print("Unanswered:")
unanswered.show()
