SSLUseStapling on
SSLStaplingCache "shmcb:logs/stapling_cache(128000)"


# ====== Log options ========================================================
ErrorLog ${APACHE_LOG_DIR}/error.log

# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
LogLevel warn

CustomLog ${APACHE_LOG_DIR}/access.log combined


# ====== Directory index options ============================================
IndexOptions FancyIndexing
IndexOptions HTMLTable
IndexOptions XHTML
IndexOptions TrackModified
IndexOptions VersionSort
IndexOptions IconsAreLinks
IndexOptions NameWidth=60
IndexOptions DescriptionWidth=*
IndexOptions Charset=UTF-8

IndexOrderDefault Descending Name
IndexStyleSheet "/system/essen.css"
IndexHeadInsert "  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><link rel=\"shortcut icon\" href=\"/system/graphics/icons/icon-simula.ico\" />"

AddType text/html .php   # <-- without this, the following php scripts have no effect!
HeaderName "/system/header.php"
ReadmeName "/system/footer.php"

AddDescription "<span style='color: green;'>Build and test successful!</span>"                 .pass
AddDescription "<span style='color: yellow;'>Build and test succeeded with warnings.</span>"   .warn
AddDescription "<span style='color: red;'>Build or test FAILED!</span>"                        .ko
AddDescription "Software package"                                                              .rpm
AddDescription "XML file"                                                                      .xml

DefaultIcon /graphics/mimetypes/unknown.png
AddIcon /graphics/emotes/face-smile-big.png              .pass
AddIcon /graphics/emotes/face-plain.png                  .warn
AddIcon /graphics/emotes/face-devilish.png               .ko
AddIcon /graphics/mimetypes/text-plain.png               .txt .log run trace
AddIcon /graphics/categories/preferences-system.png      myplc-release
AddIcon /graphics/mimetypes/text-xml.png                 .xml
AddIcon /graphics/mimetypes/application-x-rpm.png        .rpm
AddIcon /graphics/mimetypes/application-x-compress.png   .gz .bz2
AddIcon /graphics/places/folder-documents.png            ^^DIRECTORY^^
AddIcon /graphics/actions/arrow-up-double.png            ..
# ===========================================================================


Alias /graphics /usr/share/icons/oxygen/22x22/
<Directory /usr/share/icons/oxygen/22x22/>
	Options +FollowSymLinks +MultiViews 
	AllowOverride None

	# ====== Set expiration: ask for update after one week ==============
	ExpiresActive On
	ExpiresDefault "modification plus 168 hours"

	# ====== Public access ==============================================
	Require all granted
</Directory>	


Alias /system /var/www/html
<Directory /var/www/html>
	Options +FollowSymLinks
	AllowOverride None

	# ====== Set expiration: ask for update after one hour ==============
	ExpiresActive On
	ExpiresDefault "modification plus 1 hours"

	Require all granted
</Directory>


<Directory /nfs/adm/packages>
	Options +Indexes +FollowSymLinks +MultiViews
	AllowOverride None

	# ====== Set expiration: ask for update after one hour ======
	ExpiresActive On
	ExpiresDefault "modification plus 1 hours"

	Require all granted
</Directory>


<Directory /nfs/adm/mirror>
	Options +Indexes +FollowSymLinks +MultiViews
	AllowOverride None

	# ====== Set expiration: ask for update after one hour ==============
	ExpiresActive On
	ExpiresDefault "modification plus 1 hours"

	# ====== Restrict access to NorNet ==================================

        # Simula network:
        Require ip 2a02:270:2014:40::/64

	Require ip 2001:700:4100::/48
	Require ip 10.0.0.0/8
	Require ip 158.39.4.0/24
	Require ip 127.0.0.1
	Require ip ::1
</Directory>


<VirtualHost mirror.simula.nornet:80>
	ServerSignature off

	ServerName mirror.simula.nornet 

	DocumentRoot /nfs/adm/mirror
	<Directory />
		Options Indexes FollowSymLinks MultiViews
		AllowOverride None
	</Directory>
</VirtualHost>

<VirtualHost bjoernholt.simula.nornet:80 packages.simula.nornet:80 packages.nntb.no:80>
	ServerSignature off

	ServerName packages.nntb.no
	#Redirect permanent / https://packages.nntb.no/

	DocumentRoot /nfs/adm/packages
	<Directory />
		Options FollowSymLinks
		AllowOverride None
	</Directory>
</VirtualHost>

<VirtualHost packages.nntb.no:443>
	ServerSignature off

	ServerName packages.nntb.no

	SSLEngine on
	SSLOptions +StrictRequire
	SSLProtocol +ALL -SSLv2 -SSLv3 -TLSv1 -TLSv1.1
	SSLHonorCipherOrder on
	# State of the art settings:
	SSLCipherSuite ECDHE-ECDSA-AES256-GCM-SHA384:ECDH-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDH-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDH-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDH-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDH-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:ECDH-RSA-AES256-SHA:AES256-SHA
	# With DHE, **** needs dhparam configuration to be secure! (Apache >=2.4.7)! ***
	# SSLCipherSuite ECDHE-ECDSA-AES256-GCM-SHA384:ECDH-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDH-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDH-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDH-RSA-AES256-SHA384:DHE-RSA-AES256-GCM-SHA384:DHE-DSS-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-SHA:ECDH-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:ECDH-RSA-AES256-SHA:DHE-RSA-AES256-SHA:DHE-DSS-AES256-SHA

	SSLCompression off

	# Add six earth month HSTS header for all users...
	# Header add Strict-Transport-Security "max-age=15768000"
	# If you want to protect all subdomains, use the following header
	# Strict-Transport-Security: max-age=15768000 ; includeSubDomains

	# StartSSL:
	SSLCertificateFile /etc/ssl/packages.crt-signed
	SSLCertificateKeyFile /etc/ssl/packages.key
	SSLCertificateChainFile	/etc/ssl/sub.class1.server.ca.pem

	# Comodo:
	#SSLCertificateFile /etc/ssl/nntb-4096-signed.crt
	#SSLCertificateKeyFile /etc/ssl/nntb-4096.key
	#SSLCertificateChainFile /etc/ssl/nntb-4096.ca-bundle

	DocumentRoot /nfs/adm/packages
	<Directory />
		SSLRequireSSL
		Options FollowSymLinks
		AllowOverride None
	</Directory>
</VirtualHost>
